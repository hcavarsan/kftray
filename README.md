<div align="center">
  <a href="https://nodejs.org/en/">
    <img src="https://img.shields.io/badge/Node-v20.11.0-brightgreen.svg" alt="node version">
  </a>
  <a href="https://tauri.app/">
    <img src="https://img.shields.io/badge/Tauri-v1.5.8-brightgreen.svg" alt="tauri version">
  </a>
  <a href="https://react.dev">
    <img src="https://img.shields.io/badge/React-v18.2.0-brightgreen.svg" alt="react version">
  </a>

  <a href="https://www.rust-lang.org/">
    <img src="https://img.shields.io/badge/Rust-v1.75.0-brightgreen.svg" alt="rust version">
  </a>
    </div>
  <div align="center">
    <img src="https://img.shields.io/github/downloads/hcavarsan/kftray/total.svg" alt="downloads">
	<img src="https://img.shields.io/github/actions/workflow/status/hcavarsan/kftray/main.yml" alt="release=">
	</div>

<div align="center">
  <h1>KFtray</h1>
  <h3>Manage Kubernetes Port Forwarding from Your Tray</h3>

  <p>
    KFtray is a system tray application built with Tauri, Rust, React, Vite, and Chakra UI made for Kubernetes users. It eases the complexity of setting up and managing port forwarding configurations through an intuitive user interface.
  </p>

  <img src="https://github.com/hcavarsan/homebrew-kftray/blob/main/img/demo.png" width="400px" alt="KFtray Demo"/>
<p>Logo generated by Dall-E</p>
  <p>
    <a href="https://github.com/hcavarsan/kftray/releases/latest/download/kftray_0.5.5_universal.dmg">Download for macOS</a> ·
    <a href="https://github.com/hcavarsan/kftray/releases/latest/download/kftray_0.5.5_x64-setup.exe">Download for Windows</a> ·
    <a href="https://github.com/hcavarsan/kftray/releases/latest/download/kftray_0.5.5_amd64.AppImage">Download for Linux</a>
  </p>

</div>

---

## Table of Contents

- [Features](#-features)
- [Installation](#-installation)
- [Usage](#-usage)
- [Architecture](#-architecture)
- [Contributing](#-contributing)
- [License](#-license)

---

## 🚀 Features

- **Resilient Port Forwarding Connection:** Ensures continuous service even if a pod dies, by reconnecting to another running pod automatically.
- **One-Click Multiple Port Forwards:** Allows for the setup of several port forwarding instances at the same time with a single click.
- **Independent of Kubectl:** Directly interfaces with the Kubernetes API, eliminating the need for `kubectl`.
- **Multi-Protocol Support:** Enables access to internal or external servers through a Proxy Relay server deployed in a Kubernetes cluster, including TCP and UDP port forwarding.

## 📦 Installation

#### Homebrew on macOS and Linux

Install kftray with ease using Homebrew by tapping into the custom repository. Run the following commands:

For Linux:

```bash
brew tap hcavarsan/kftray
brew install --HEAD kftray
```

For macOS:

```bash
brew tap hcavarsan/kftray
brew install --HEAD kftray
```

_Please check the caveats section for global app creation instructions after installation._

#### Building from Source

##### Requirements

- Node.js and pnpm or yarn for building the frontend.
- Rust for building the backend.

To compile `kftray`, these steps should be followed:

1. Clone the repository:
   ```bash
   git clone https://github.com/hcavarsan/kftray.git
   ```
2. Navigate to the cloned directory:
   ```bash
   cd kftray
   ```
3. Install dependencies:
   ```bash
   pnpm install
   ```
4. Launch the application in development mode:
   ```bash
   pnpm run tauri dev
   ```

## 🧭 Usage

Below is an intuitive guide to getting started with KFtray.

### 🎛 Configure Port Forwards

Use the UI to add new port forward settings. Necessary details include:

- `Workload Type`: Proxy or Service.
- `Alias`: A unique name for the settings.
- `Context`, `Namespace`, `Service`: As per Kubernetes configuration.
- `Remote Address`: For Proxy type workload.
- `Protocol`: TCP or UDP.
- `Local and Remote Ports`: Endpoint details.

<details>
<summary><b>Create Service Configuration Screenshot</b></summary>
<p align="center">
<img src="img/createservice.png" alt="Create Service Configuration"/>
</p>
</details>

### ▶️ Activate Configurations

- **Single Configuration:** Click to initiate a single port forward.
- **All Configurations:** Start multiple port forward simultaneously.

<details>
<summary><b>Start Single Configuration Screenshot</b></summary>
<p align="center">
<img src="img/single.png" alt="Start Single Configuration"/>
</p>
</details>

### 🗂 Configuration Management

- **Export/Import:** Share configurations effortlessly with JSON files.
- **Local Storage:** Keep configurations safe and sound in "$HOME/.kftray/configs.db".
- **Custom Server Pod:** Customize the kftray server pod manifest in "$HOME/.kftray/proxy_manifest.json".

#### Configuration JSON Sample

Below is an example of an exported JSON configuration:

```json
[
  {
    "alias": "consul-ui",
    "context": "kind-7",
    "local_port": 8500,
    "namespace": "consul",
    "protocol": "tcp",
    "remote_port": 8500,
    "service": "consul-ui",
    "workload_type": "service"
  },
  {
    "alias": "redis-gcp",
    "context": "kind-6",
    "local_port": 26379,
    "namespace": "default",
    "protocol": "udp",
    "remote_address": "redis-prod.gcp.internal",
    "remote_port": 6379,
    "workload_type": "proxy"
  }
]
```

## 🏗 Architecture

### Server

KFtray Server is a Golang application that relays UDP/TCP traffic to an upstream server. Learn more [here](https://github.com/hcavarsan/kftray/tree/main/kftray-server).

### Forwarding Flows

- **TCP Forwarding:** A local TCP socket, similar to kubectl, can be used to communicate with a Kubernetes pod. This approach offers parallel execution and improved resilience.

```mermaid
sequenceDiagram
Application->>Kubernetes Pod: Opens TCP socket, starts port-forwarding
Kubernetes Pod-->>Application: Responds with TCP Packet
```

- **Proxy TCP Forwarding:** The local TCP connects to the kftray-server pod, which then sends TCP packet to the upstream server.

```mermaid
sequenceDiagram
Application->>Kubernetes Pod: Socket to kftray-server, facilitates TCP relay
Kubernetes Pod->>Remote Service: Relays TCP Packet
Remote Service-->>Kubernetes Pod: Responds
Kubernetes Pod-->>Application: Returns TCP Packet
```

- **UDP Forwarding:** The KFtray client opens a local UDP socket and connects a local TCP socket to the kftray-server pod. The TCP socket sends UDP packets over TCP, which are then forwarded to the upstream server.

```mermaid
sequenceDiagram
Application->>Kubernetes Pod: UDP socket, TCP port-forward to kftray-server
Kubernetes Pod->>Service/Remote: Converts to UDP, sends packet
Service/Remote-->>Kubernetes Pod: Responds with UDP Packet
Kubernetes Pod-->>Application: Relays as TCP
```

## 👥 Contributing

- 🛠 **Pull Requests**: Feel free to create pull requests for bug fixes, new features, or improvements.
- 📝 **Issues**: Report bugs, suggest new features, or ask questions.
- 💡 **Feedback**: Your feedback helps improve kftray.

## 📄 License

KFtray is available under the [MIT License](LICENSE.md), which is included in the repository. See the LICENSE file for full details.

## Stargazers over time

[![Stargazers over time](https://starchart.cc/hcavarsan/kftray.svg?variant=dark)](https://starchart.cc/hcavarsan/kftray)
